rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /events/{eventId} {
      allow read: if true;
      allow create: if
        request.resource.data.keys().hasOnly(['title', 'timezone', 'slots', 'createdAt']) &&
        request.resource.data.title is string &&
        request.resource.data.title.size() > 0 &&
        request.resource.data.title.size() <= 120 &&
        request.resource.data.timezone is string &&
        request.resource.data.timezone.size() > 0 &&
        request.resource.data.timezone.size() <= 80 &&
        request.resource.data.slots is list &&
        request.resource.data.slots.size() > 0 &&
        request.resource.data.slots.size() <= 100;
      allow update, delete: if false;

      match /responses/{responseId} {
        allow read: if true;
        allow create: if
          request.resource.data.keys().hasOnly(['name', 'selectedSlotIds', 'submittedAt']) &&
          request.resource.data.name is string &&
          request.resource.data.name.size() > 0 &&
          request.resource.data.name.size() <= 80 &&
          request.resource.data.selectedSlotIds is list &&
          request.resource.data.selectedSlotIds.size() > 0 &&
          request.resource.data.selectedSlotIds.size() <= 100;
        allow update, delete: if false;
      }
    }
  }
}
